{"version":3,"file":"js/850.7031ed70.js","mappings":"qJAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,MAAM,CAAC,GAAK,OAAO,OAAS,cAAc,KAAO,QAAQC,GAAG,CAAC,OAASL,EAAIM,iBACnK,EACIC,EAAkB,G,+BCOtB,GACAC,KAAA,QACAC,WAAA,GACAC,IAAAA,GACA,QACA,EACAC,MAAA,GACAC,MAAA,GACAC,SAAA,GACAC,OAAAA,GACA,EACAC,QAAA,CAMAT,YAAAA,CAAAU,GACA,KAAAC,SAAAD,EAAAE,OAAAC,MAAA,GAAAX,KACA,KAAAW,MAAAH,EAAAE,OAAAC,MACAC,QAAAC,IAAA,aAAAF,OACAC,QAAAC,IAAA,gBAAAF,MAAA,IACA,IAAAG,GAAA,EACA,QAAAC,EAAA,EAAAA,EAAA,KAAAJ,MAAAK,OAAAD,IAAA,CACA,MAAAE,EAAA,KAAAN,MAAAI,GAAAf,KAAAkB,MAAA,KACAC,EAAAF,EAAAA,EAAAD,OAAA,GACA,eAAAI,SAAAD,KACAL,GAAA,EAEA,CACAA,IACA,KAAAO,SAAAC,MAAA,4BACA,KAAAC,MAAAC,OACA,KAAAf,SAAA,GACA,KAAAc,MAAAC,KAAAC,MAAA,KAGA,KAAAC,WACA,KAAAC,kBAAA,KAAAhB,MAAA,GAIA,EACAgB,iBAAAA,CAAAH,GACA,WAAAI,SAAA,CAAAC,EAAAC,KACA,MAAAC,EAAA,IAAAC,WACAD,EAAAE,kBAAAT,GACAO,EAAAG,OAAA,KACA,MAAAC,EAAAJ,EAAAK,OACAC,EAAA,IAAAC,IAAAA,UACAD,EAAAE,KACAC,KAAAL,GACAM,MAAA,KACA,MAAAC,EAAAL,EAAAM,aAAA,GACAC,EAAAF,EAAAG,OAAA,GAAAC,OAGAF,EAAAG,QACAnC,QAAAC,IAAA,WAAA+B,GAEA,MAAAI,EAAA,GAEAN,EAAAO,iBAAAC,QAAAC,KAAAA,GAAAnC,SAAAoC,SAAAC,IAEAA,EAAAN,QAEA,MAAAO,EAAA,GACAD,EAAAD,SAAA,CAAAG,EAAAC,KACAF,EAAAV,EAAAY,IAAAD,CAAA,IAEAP,EAAAS,KAAAH,EAAA,IAEAN,EAAAD,QACAnC,QAAAC,IAAA,YAAAmC,GACAnB,EAAA,2BACA6B,OAAAlD,IAEAsB,EAAA,gDACA,CACA,GAEA,EACA,cAAAJ,GACA,MAAAW,EAAA,IAAAC,IAAAA,UACAqB,QAAAtB,EAAAE,KAAAC,KAAA,KAAA7B,MAAA,IACAC,QAAAC,IAAA,MAAA8C,EACA,IC/F8P,I,UCO1PC,GAAY,OACd,EACArE,EACAQ,GACA,EACA,KACA,WACA,MAIF,EAAe6D,EAAiB,O","sources":["webpack://yian/./src/views/excelJs/index.vue","webpack://yian/src/views/excelJs/index.vue","webpack://yian/./src/views/excelJs/index.vue?21a6","webpack://yian/./src/views/excelJs/index.vue?695f"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('input',{attrs:{\"id\":\"file\",\"accept\":\".xlsx, .xls\",\"type\":\"file\"},on:{\"change\":_vm.handleChange}})])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <input id=\"file\" accept=\".xlsx, .xls\" type=\"file\" @change=\"handleChange\"/>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Excel from 'exceljs';\r\n\r\nexport default {\r\n  name: 'index',\r\n  components: {},\r\n  data () {\r\n    return {};\r\n  },\r\n  props: {},\r\n  watch: {},\r\n  computed: {},\r\n  mounted () {\r\n  },\r\n  methods: {\r\n    /**\r\n     * @Description 选择文件后触发\r\n     * @author wangkangzhang\r\n     * @date 2023/14/10\r\n     */\r\n    handleChange (e) {\r\n      this.filePath = e.target.files[0].name;\r\n      this.files = e.target.files;\r\n      console.log('files', this.files);\r\n      console.log('files[0]', this.files[0]);\r\n      let flag = true;\r\n      for (let i = 0; i < this.files.length; i++) {\r\n        const arr = this.files[i].name.split('.');\r\n        const fileType = arr[arr.length - 1];\r\n        if (!['xls', 'xlsx'].includes(fileType)) {\r\n          flag = false;\r\n        }\r\n      }\r\n      if (!flag) {\r\n        this.$message.error('请选择正确文件类型(.xls，.xlsx)导入！');\r\n        if (this.$refs.file) {\r\n          this.filePath = '';\r\n          this.$refs.file.value = '';\r\n        }\r\n      }\r\n      this.fileInfo();\r\n      this.validateExcelFile(this.files[0]);\r\n      // this.readFile().then(value => {\r\n      //   console.log('value', value);\r\n      // });\r\n    },\r\n    validateExcelFile (file) {\r\n      return new Promise((resolve, reject) => {\r\n        const reader = new FileReader();\r\n        reader.readAsArrayBuffer(file);\r\n        reader.onload = () => {\r\n          const buffer = reader.result;\r\n          const workbook = new Excel.Workbook();\r\n          workbook.xlsx\r\n            .load(buffer)\r\n            .then(() => {\r\n              const worksheet = workbook.getWorksheet(1);\r\n              const rowCount = worksheet.getRow(1).values; // 获取行\r\n              // const columnCount = worksheet.getColumn(1).values; // 获取列\r\n              //  validate table data\r\n              rowCount.shift();\r\n              console.log('rowCount', rowCount);\r\n              // console.log('columnCount', columnCount);\r\n              const excelList = [];\r\n\r\n              worksheet.getSheetValues().filter(temp => !!temp?.length).forEach(item => { // 移除空行\r\n                // 移除每行首个空元素\r\n                item.shift();\r\n                // 定义临时对象存储每一行内容\r\n                const tempObj = {};\r\n                item.forEach((item2, index2) => {\r\n                  tempObj[rowCount[index2]] = item2;\r\n                });\r\n                excelList.push(tempObj);\r\n              });\r\n              excelList.shift();\r\n              console.log('excelList', excelList);\r\n              resolve('Excel file is valid.');\r\n            }).catch(e => {\r\n            // eslint-disable-next-line prefer-promise-reject-errors\r\n              reject('Error occurred while loading the workbook.');\r\n            });\r\n        };\r\n      });\r\n    },\r\n    async fileInfo () {\r\n      const workbook = new Excel.Workbook();\r\n      const res = await workbook.xlsx.load(this.files[0]);\r\n      console.log('res', res);\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=0fdc7edc&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0fdc7edc\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","attrs","on","handleChange","staticRenderFns","name","components","data","props","watch","computed","mounted","methods","e","filePath","target","files","console","log","flag","i","length","arr","split","fileType","includes","$message","error","$refs","file","value","fileInfo","validateExcelFile","Promise","resolve","reject","reader","FileReader","readAsArrayBuffer","onload","buffer","result","workbook","Excel","xlsx","load","then","worksheet","getWorksheet","rowCount","getRow","values","shift","excelList","getSheetValues","filter","temp","forEach","item","tempObj","item2","index2","push","catch","res","component"],"sourceRoot":""}